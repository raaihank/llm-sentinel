(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{747:(e,s,t)=>{Promise.resolve().then(t.bind(t,8203))},8203:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>X});var a=t(5155),n=t(2115),l=t(2821),i=t(5889);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,i.QP)((0,l.$)(s))}function c(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:r("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function d(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:r("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:r("leading-none font-semibold",s),...t})}function x(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:r("px-6",s),...t})}var m=t(2467);let u=(0,t(3101).F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function h(e){let{className:s,variant:t,asChild:n=!1,...l}=e,i=n?m.DX:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:r(u({variant:t}),s),...l})}var f=t(9484);function p(e){let{className:s,value:t,...n}=e;return(0,a.jsx)(f.bL,{"data-slot":"progress",className:r("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...n,children:(0,a.jsx)(f.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}var j=t(1130);function g(e){let{className:s,...t}=e;return(0,a.jsx)(j.bL,{"data-slot":"switch",className:r("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(j.zi,{"data-slot":"switch-thumb",className:r("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var v=t(5433);function N(e){let{className:s,...t}=e;return(0,a.jsx)(v.bL,{"data-slot":"tabs",className:r("flex flex-col gap-2",s),...t})}function b(e){let{className:s,...t}=e;return(0,a.jsx)(v.B8,{"data-slot":"tabs-list",className:r("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function y(e){let{className:s,...t}=e;return(0,a.jsx)(v.l9,{"data-slot":"tabs-trigger",className:r("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function w(e){let{className:s,...t}=e;return(0,a.jsx)(v.UC,{"data-slot":"tabs-content",className:r("flex-1 outline-none",s),...t})}var k=t(5483),A=t(5229);function R(e){let{...s}=e;return(0,a.jsx)(k.bL,{"data-slot":"dialog",...s})}function S(e){let{...s}=e;return(0,a.jsx)(k.ZL,{"data-slot":"dialog-portal",...s})}function D(e){let{className:s,...t}=e;return(0,a.jsx)(k.hJ,{"data-slot":"dialog-overlay",className:r("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function q(e){let{className:s,children:t,showCloseButton:n=!0,...l}=e;return(0,a.jsxs)(S,{"data-slot":"dialog-portal",children:[(0,a.jsx)(D,{}),(0,a.jsxs)(k.UC,{"data-slot":"dialog-content",className:r("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...l,children:[t,n&&(0,a.jsxs)(k.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(A.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function C(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:r("flex flex-col gap-2 text-center sm:text-left",s),...t})}function E(e){let{className:s,...t}=e;return(0,a.jsx)(k.hE,{"data-slot":"dialog-title",className:r("text-lg leading-none font-semibold",s),...t})}function L(e){let{className:s,...t}=e;return(0,a.jsx)(k.VY,{"data-slot":"dialog-description",className:r("text-muted-foreground text-sm",s),...t})}var O=t(2912);function T(e){let{className:s,children:t,...n}=e;return(0,a.jsxs)(O.bL,{"data-slot":"scroll-area",className:r("relative",s),...n,children:[(0,a.jsx)(O.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,a.jsx)(P,{}),(0,a.jsx)(O.OK,{})]})}function P(e){let{className:s,orientation:t="vertical",...n}=e;return(0,a.jsx)(O.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:r("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",s),...n,children:(0,a.jsx)(O.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var M=t(7268);function z(e){let{className:s,orientation:t="horizontal",decorative:n=!0,...l}=e;return(0,a.jsx)(M.b,{"data-slot":"separator",decorative:n,orientation:t,className:r("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...l})}var I=t(9427),K=t(7494),_=t(906),B=t(9068),H=t(2056),F=t(7910),J=t(6154),W=t(5710),Y=t(9708),U=t(5880),V=t(7828),G=t(4172),Q=t(6983);function X(){var e,s,t,l,i,r,m,u,f,j,v,k,A,S,D,O,P,M,X,Z,$;let[ee,es]=(0,n.useState)(!0),[et,ea]=(0,n.useState)(null),[en,el]=(0,n.useState)(!1),[ei,er]=(0,n.useState)(null),[ec,ed]=(0,n.useState)({totalRequests:0,totalDetections:0,activeDetectors:41,uptime:"0h 0m",recentEvents:[]});(0,n.useEffect)(()=>{document.documentElement.classList.toggle("dark",ee)},[ee]),(0,n.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/config");if(e.ok){let s=await e.json();er(s)}}catch(e){console.error("Error fetching config:",e)}};(async()=>{try{let e=await fetch("/api/stats");if(e.ok){let s=await e.json();ed({totalRequests:s.totalRequests,totalDetections:s.recentMetrics.reduce((e,s)=>e+s.detections.length,0),activeDetectors:41,uptime:"0h 0m",recentEvents:s.recentMetrics.slice(0,5).map(e=>{var s,t,a;return{id:e.id,timestamp:e.timestamp,entityType:(null==(s=e.detections[0])?void 0:s.entityType)||"unknown",maskedAs:(null==(t=e.detections[0])?void 0:t.masked)||"[MASKED]",occurrences:(null==(a=e.detections[0])?void 0:a.count)||1,endpoint:e.endpoint,provider:ex(e.endpoint)}})})}}catch(e){console.error("Error fetching initial stats:",e)}})(),e();let s="https:"===window.location.protocol?"wss:":"ws:",t=new WebSocket("".concat(s,"//").concat(window.location.host,"/ws"));return t.onopen=()=>{console.log("WebSocket connected")},t.onmessage=e=>{try{let n=JSON.parse(e.data);switch(n.type){case"stats":ed(e=>({...e,totalRequests:n.data.totalRequests||e.totalRequests,uptime:"".concat(Math.floor(n.data.uptime/3600),"h ").concat(Math.floor(n.data.uptime%3600/60),"m")}));break;case"request_event":if(n.data.hasDetections){var s,t,a;let e={id:n.data.id,timestamp:n.data.timestamp,entityType:(null==(s=n.data.detections[0])?void 0:s.entityType)||"unknown",maskedAs:(null==(t=n.data.detections[0])?void 0:t.masked)||"[MASKED]",occurrences:(null==(a=n.data.detections[0])?void 0:a.count)||1,endpoint:n.data.endpoint,provider:ex(n.data.endpoint)};ed(s=>{let t,a=s.recentEvents.findIndex(e=>e.id===n.data.id);return a>=0?(t=[...s.recentEvents])[a]=e:t=[e,...s.recentEvents.slice(0,9)],{...s,totalDetections:a>=0?s.totalDetections:s.totalDetections+n.data.detections.length,totalRequests:a>=0||"processing"!==n.data.status?s.totalRequests:s.totalRequests+1,recentEvents:t}})}else"processing"===n.data.status&&ed(e=>({...e,totalRequests:e.totalRequests+1}))}}catch(e){console.error("WebSocket message parsing error:",e)}},t.onclose=()=>{console.log("WebSocket disconnected"),setTimeout(()=>{window.location.reload()},5e3)},t.onerror=e=>{console.error("WebSocket error:",e)},()=>{t.close()}},[]);let eo=async e=>{try{let s=await fetch("/api/request/".concat(e));if(s.ok){let e=await s.json();ea(e),el(!0)}else console.error("Failed to fetch request details")}catch(e){console.error("Error fetching request details:",e)}},ex=e=>{if(e.includes("/openai")||e.includes("/v1/chat")||e.includes("/v1/completions"))return"OpenAI";if(e.includes("/ollama")||e.includes("/api/generate")||e.includes("/api/chat"))return"Ollama";if(e.includes("/cursor"))return"Cursor";if(e.includes("/copilot")||e.includes("/github"))return"GitHub Copilot";if(e.includes("/claude")||e.includes("/anthropic"))return"Claude";return"Unknown"},em=e=>"OpenAI"===e||"Ollama"===e?"text-foreground bg-muted border-border":"text-muted-foreground bg-muted/50 border-border",eu=(null==ei||null==(s=ei.config)||null==(e=s.detection)?void 0:e.enabledRules)?[{name:"API Keys",count:ei.config.detection.enabledRules.filter(e=>e.includes("Api")||e.includes("Key")).length},{name:"Personal Data",count:ei.config.detection.enabledRules.filter(e=>e.includes("email")||e.includes("phone")).length},{name:"Credentials",count:ei.config.detection.enabledRules.filter(e=>e.includes("aws")||e.includes("token")).length},{name:"All Active",count:ei.config.detection.enabledRules.length}]:[{name:"Loading...",count:0}];return(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground p-6",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-foreground",children:"\uD83D\uDEE1️ LLM-Sentinel"}),(0,a.jsx)("p",{className:"text-muted-foreground text-lg",children:"Privacy-first AI proxy • Real-time protection monitoring"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsx)(g,{checked:ee,onCheckedChange:es}),(0,a.jsx)(K.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(h,{variant:"outline",className:"neon-glow",children:[(0,a.jsx)(_.A,{className:"w-4 h-4 mr-2"}),"Live"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsxs)(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o,{className:"text-sm font-medium",children:"Total Requests"}),(0,a.jsx)(B.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:ec.totalRequests.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"+12.5% from last hour"}),(0,a.jsx)(p,{value:75,className:"mt-2"})]})]}),(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsxs)(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o,{className:"text-sm font-medium",children:"Detections"}),(0,a.jsx)(H.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:ec.totalDetections}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sensitive data blocked"}),(0,a.jsx)(p,{value:60,className:"mt-2"})]})]}),(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsxs)(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o,{className:"text-sm font-medium",children:"Active Detectors"}),(0,a.jsx)(F.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[ec.activeDetectors,"/41"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Protection enabled"}),(0,a.jsx)(p,{value:100,className:"mt-2"})]})]}),(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsxs)(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o,{className:"text-sm font-medium",children:"Uptime"}),(0,a.jsx)(J.A,{className:"h-4 w-4"})]}),(0,a.jsxs)(x,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:ec.uptime}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"99.9% availability"}),(0,a.jsx)(p,{value:99.9,className:"mt-2"})]})]})]}),(0,a.jsxs)(N,{defaultValue:"overview",className:"space-y-6",children:[(0,a.jsxs)(b,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(y,{value:"overview",children:"Overview"}),(0,a.jsx)(y,{value:"detectors",children:"Detectors"}),(0,a.jsx)(y,{value:"events",children:"Live Events"}),(0,a.jsx)(y,{value:"settings",children:"Settings"})]}),(0,a.jsx)(w,{value:"overview",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center space-x-2",children:[(0,a.jsx)(W.A,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("span",{children:"Detection Categories"})]})}),(0,a.jsx)(x,{className:"space-y-4",children:eu.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full border border-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:e.name})]}),(0,a.jsx)(h,{variant:"secondary",children:e.count})]},s))})]}),(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center space-x-2",children:[(0,a.jsx)(_.A,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("span",{children:"Recent Activity"})]})}),(0,a.jsx)(x,{className:"space-y-4",children:ec.recentEvents.map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/50 hover:bg-muted/70 cursor-pointer transition-colors",onClick:()=>{e.id&&eo(e.id)},children:[(0,a.jsx)(Y.A,{className:"w-4 h-4 mt-1"}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(h,{variant:"outline",className:"text-xs",children:e.maskedAs}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString()}),(0,a.jsx)(U.A,{className:"w-3 h-3 text-muted-foreground"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.endpoint," • ",e.occurrences," occurrence",e.occurrences>1?"s":""]}),e.provider&&(0,a.jsx)(h,{variant:"secondary",className:"text-xs px-2 py-1 ".concat(em(e.provider)," dark:text-foreground dark:bg-muted"),children:e.provider})]})]})]},e.id))})]})]})}),(0,a.jsx)(w,{value:"detectors",className:"space-y-6",children:(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsx)(d,{children:(0,a.jsx)(o,{children:"All Detection Rules (41 Active)"})}),(0,a.jsx)(x,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["OpenAI API Key","Claude API Key","AWS Access Key","Email Address","Credit Card","SSH Private Key","JWT Token","Phone Number","PostgreSQL URL","MongoDB URL","Stripe API Key","GitHub Token","Docker Registry Auth","Slack Token","Discord Token","IP Address"].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30",children:[(0,a.jsx)("span",{className:"text-sm",children:e}),(0,a.jsx)(h,{variant:"outline",className:"text-xs",children:"Active"})]},s))})})]})}),(0,a.jsx)(w,{value:"events",className:"space-y-6",children:(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Live Detection Events"}),(0,a.jsxs)(h,{variant:"outline",className:"animate-pulse-slow",children:[(0,a.jsx)(V.A,{className:"w-3 h-3 mr-1"}),"Monitoring"]})]})}),(0,a.jsx)(x,{children:(0,a.jsx)("div",{className:"space-y-3",children:ec.recentEvents.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-muted/30 border-l-4 border-foreground",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.maskedAs}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.endpoint," • ",new Date(e.timestamp).toLocaleString()]})]}),(0,a.jsx)(h,{variant:"outline",children:e.occurrences})]},e.id))})})]})}),(0,a.jsx)(w,{value:"settings",className:"space-y-6",children:(0,a.jsxs)(c,{className:"glass-effect",children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center space-x-2",children:[(0,a.jsx)(W.A,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("span",{children:"Complete Configuration"})]})}),(0,a.jsx)(x,{children:ei?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-muted/50 border-l-4 border-primary p-4 rounded",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2",children:ei.note}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:Object.entries(ei.examples).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s,":"]}),(0,a.jsx)("br",{}),(0,a.jsx)("code",{className:"bg-background px-2 py-1 rounded",children:t})]},s)})})]}),(0,a.jsx)(z,{}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Current Configuration"}),(0,a.jsx)(h,{variant:"outline",className:"text-xs",children:"Read-Only"})]}),(0,a.jsx)(T,{className:"h-96 w-full rounded border bg-muted/30 p-4",children:(0,a.jsx)("pre",{className:"text-xs whitespace-pre-wrap",children:JSON.stringify(ei.config,null,2)})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Configuration Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)(F.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Detection"})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Enabled:"}),(0,a.jsx)(h,{variant:(null==(t=ei.config.detection)?void 0:t.enabled)?"default":"destructive",children:(null==(l=ei.config.detection)?void 0:l.enabled)?"Yes":"No"})]}),(null==(i=ei.config.detection)?void 0:i.enabledRules)&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Active Rules:"}),(0,a.jsx)(h,{variant:"secondary",children:ei.config.detection.enabledRules.length})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)(_.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Logging"})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Level:"}),(0,a.jsx)(h,{variant:"outline",children:(null==(r=ei.config.logging)?void 0:r.logLevel)||"INFO"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"To File:"}),(0,a.jsx)(h,{variant:(null==(m=ei.config.logging)?void 0:m.logToFile)?"default":"destructive",children:(null==(u=ei.config.logging)?void 0:u.logToFile)?"Yes":"No"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Console:"}),(0,a.jsx)(h,{variant:(null==(f=ei.config.logging)?void 0:f.logToConsole)?"default":"destructive",children:(null==(j=ei.config.logging)?void 0:j.logToConsole)?"Yes":"No"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)(Y.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Security"})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Redact API Keys:"}),(0,a.jsx)(h,{variant:(null==(v=ei.config.security)?void 0:v.redactApiKeys)?"default":"destructive",children:(null==(k=ei.config.security)?void 0:k.redactApiKeys)?"Yes":"No"})]}),(null==(A=ei.config.security)?void 0:A.redactCustomHeaders)&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Custom Headers:"}),(0,a.jsx)(h,{variant:"secondary",children:ei.config.security.redactCustomHeaders.length})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)(H.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Notifications"})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Enabled:"}),(0,a.jsx)(h,{variant:(null==(S=ei.config.notifications)?void 0:S.enabled)?"default":"destructive",children:(null==(D=ei.config.notifications)?void 0:D.enabled)?"Yes":"No"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Sound:"}),(0,a.jsx)(h,{variant:(null==(O=ei.config.notifications)?void 0:O.sound)?"default":"destructive",children:(null==(P=ei.config.notifications)?void 0:P.sound)?"Yes":"No"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)(G.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Server"})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Port:"}),(0,a.jsx)(h,{variant:"outline",children:(null==(M=ei.config.server)?void 0:M.port)||5050})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"OpenAI:"}),(0,a.jsx)(h,{variant:"outline",className:"text-xs",children:(null==(X=ei.config.openai)?void 0:X.target)||"api.openai.com"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Ollama:"}),(0,a.jsx)(h,{variant:"outline",className:"text-xs",children:(null==(Z=ei.config.ollama)?void 0:Z.target)||"localhost:11434"})]})]})]}),(null==($=ei.config.detection)?void 0:$.enabledRules)&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)(V.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Detection Rules"})]}),(0,a.jsx)(T,{className:"h-32",children:(0,a.jsx)("div",{className:"space-y-1",children:ei.config.detection.enabledRules.map((e,s)=>(0,a.jsx)(h,{variant:"outline",className:"text-xs mr-1 mb-1",children:e},s))})})]})]})]})]}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"animate-pulse",children:"Loading configuration..."})})})]})})]}),(0,a.jsx)("div",{className:"text-center text-sm text-muted-foreground pt-8 border-t border-border/50",children:(0,a.jsxs)("p",{children:["LLM-Sentinel • Built with ❤️ by ",(0,a.jsx)("a",{href:"https://github.com/raaihank",className:"text-primary hover:text-primary/80",children:"Raihan K."})]})})]}),(0,a.jsx)(R,{open:en,onOpenChange:el,children:(0,a.jsxs)(q,{className:"max-w-5xl w-[95vw] max-h-[95vh] overflow-hidden border-2 border-foreground/50 shadow-xl shadow-foreground/20 bg-background/95 backdrop-blur-sm",children:[(0,a.jsxs)(C,{className:"pb-4",children:[(0,a.jsxs)(E,{className:"flex items-center space-x-2",children:[(0,a.jsx)(G.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Request Details"}),et&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h,{variant:"outline",className:"ml-2",children:et.status}),(0,a.jsx)(h,{variant:"secondary",className:"text-xs px-2 py-1 ".concat(em(ex(et.endpoint))," dark:text-foreground dark:bg-muted"),children:ex(et.endpoint)})]})]}),(0,a.jsx)(L,{children:"Detailed information about the intercepted request and response"})]}),et&&(0,a.jsx)(T,{className:"max-h-[75vh] pr-4",children:(0,a.jsxs)("div",{className:"space-y-6 pb-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Method"}),(0,a.jsx)(h,{variant:"secondary",children:et.method})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Status"}),(0,a.jsx)(h,{variant:200===et.responseStatus?"default":"destructive",children:et.responseStatus||"N/A"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-sm font-medium flex items-center space-x-1",children:[(0,a.jsx)(Q.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Processing"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[et.processingTimeMs,"ms"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-sm font-medium flex items-center space-x-1",children:[(0,a.jsx)(Q.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"API Response"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[et.apiResponseTimeMs||0,"ms"]})]})]}),(0,a.jsx)(z,{}),et.detections&&et.detections.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center space-x-2",children:[(0,a.jsx)(H.A,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("span",{children:"Sensitive Data Detections"})]}),(0,a.jsx)("div",{className:"grid gap-2",children:et.detections.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-slate-50 dark:bg-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(Y.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"font-medium",children:e.entityType})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(h,{variant:"outline",children:e.masked}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["\xd7",e.count]})]})]},s))})]}),(0,a.jsx)(z,{})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Request"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Endpoint"}),(0,a.jsxs)("code",{className:"text-sm bg-slate-100 dark:bg-slate-800 p-2 rounded block",children:[et.method," ",et.endpoint]})]}),et.requestHeaders&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Headers"}),(0,a.jsx)(T,{className:"h-32",children:(0,a.jsx)("pre",{className:"text-xs bg-slate-100 dark:bg-slate-800 p-3 rounded whitespace-pre overflow-x-auto",children:JSON.stringify(et.requestHeaders,null,4)})})]}),et.requestBody&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium mb-2 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"Original Request Body"}),(0,a.jsxs)(h,{variant:"outline",className:"text-xs",children:[et.contentLength," bytes"]})]}),(0,a.jsx)(T,{className:"h-40",children:(0,a.jsx)("pre",{className:"text-xs bg-slate-100 dark:bg-slate-800 p-3 rounded whitespace-pre overflow-x-auto",children:et.requestBody})})]}),et.maskedRequestBody&&et.maskedRequestBody!==et.requestBody&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium mb-2 flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"Masked Request Body (Sent to AI)"}),(0,a.jsx)(h,{variant:"secondary",className:"text-xs",children:"MASKED"})]}),(0,a.jsx)(T,{className:"h-40",children:(0,a.jsx)("pre",{className:"text-xs bg-slate-100 dark:bg-slate-800 p-3 rounded whitespace-pre overflow-x-auto",children:et.maskedRequestBody})})]})]})]}),(0,a.jsx)(z,{}),et.responseBody&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Response"}),(0,a.jsxs)("div",{className:"space-y-3",children:[et.responseHeaders&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Response Headers"}),(0,a.jsx)(T,{className:"h-32",children:(0,a.jsx)("pre",{className:"text-xs bg-slate-100 dark:bg-slate-800 p-3 rounded whitespace-pre overflow-x-auto",children:JSON.stringify(et.responseHeaders,null,4)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2",children:"Response Body"}),(0,a.jsx)(T,{className:"h-48",children:(0,a.jsx)("pre",{className:"text-xs bg-slate-100 dark:bg-slate-800 p-3 rounded whitespace-pre overflow-x-auto",children:et.responseBody})})]})]})]}),et.logs&&et.logs.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Processing Logs"}),(0,a.jsx)("div",{className:"space-y-2",children:et.logs.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-slate-50 dark:bg-slate-700",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.timestamp).toLocaleTimeString()}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.message}),e.data&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:(0,a.jsx)("pre",{className:"whitespace-pre overflow-x-auto bg-slate-100 dark:bg-slate-800 p-2 rounded",children:JSON.stringify(e.data,null,4)})})]}),(0,a.jsx)(h,{variant:"outline",className:"text-xs",children:e.level})]},s))})]})]})]})})]})})]})}}},e=>{e.O(0,[722,441,255,358],()=>e(e.s=747)),_N_E=e.O()}]);